@model IEnumerable<EmployeeTrackingSystem.Models.Employee>

@{
    ViewData["Title"] = "Employee Portal";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<head>
    <style>
        /* basic positioning */
        .legend { list-style: none; }
        .legend li { float: left; margin-right: 10px; }
        .legend span { border: 1px solid #ccc; float: left; width: 16px; height: 16px; margin: 2px; }
        /* your colors */
        .legend .good { background-color: #00FF00; }
        .legend .lessthan30 { background-color: #FFFF00; }
        .legend .lessthan14 { background-color: #FFC500; }
        .legend .lessthan7 { background-color: #FF6500; }
        .legend .expired { background-color: #FF0000; }
    </style>
</head>
     
<h2><img src="~/images/ACElogo.jpg" alt="ACE" height="40" />@ViewData["Title"]</h2>
     @if (User.IsInRole("Admin") || User.IsInRole("Manager"))
     {
        <p>
            <a asp-action="Create" class="btn btn-primary">Create New</a>
        </p>
     }
     
<ul class="legend">
    <li><span class="good"></span> Good</li>
    <li><span class="lessthan30"></span> Less than 30 days</li>
    <li><span class="lessthan14"></span> Less than 14 days</li>
    <li><span class="lessthan7"></span> Less than 7 days</li>
    <li><span class="expired"></span> Expired</li>
</ul>

<table class="table">
    <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.Name)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.Email)
            </th>
            <th>
                Status
            </th>
            @*<th>
            @Html.DisplayNameFor(model => model.Address)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.City)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.State)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Zip)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Phone)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.DateOfBirth)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.HireDate)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.LicenseNumber)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.CertificationType)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.CertificationStartDate)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.CertificationEndDate)
        </th>*@
            <th></th>
        </tr>
    </thead>
    <tbody>
   @foreach (var item in Model) {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Name)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Email)
            </td>
            @if (((item.Cert1EndDate - DateTime.Now).TotalDays <= 0 && item.RequiredCerts.Contains("1")) || ((item.Cert2EndDate - DateTime.Now).TotalDays <= 0 && item.RequiredCerts.Contains("2")) || ((item.Cert3EndDate - DateTime.Now).TotalDays <= 0 && item.RequiredCerts.Contains("3")))
            {
                <td bgcolor="#FF0000">
                    <font color="#FFFFFF"><strong>Expired</strong></font>
                </td>
            }
            else if (((item.Cert1EndDate - DateTime.Now).TotalDays <= 7 && item.RequiredCerts.Contains("1")) || ((item.Cert2EndDate - DateTime.Now).TotalDays <= 7 && item.RequiredCerts.Contains("2")) || ((item.Cert3EndDate - DateTime.Now).TotalDays <= 7 && item.RequiredCerts.Contains("3")))
            {
            <td bgcolor="#FF6500">
                <strong>Less than 7 days</strong>
            </td>
            }
            else if (((item.Cert1EndDate - DateTime.Now).TotalDays <= 14 && item.RequiredCerts.Contains("1")) || ((item.Cert2EndDate - DateTime.Now).TotalDays <= 14 && item.RequiredCerts.Contains("2")) || ((item.Cert3EndDate - DateTime.Now).TotalDays <= 14 && item.RequiredCerts.Contains("3")))
            {
            <td bgcolor="#FFC500">
                <strong>Less than 14 days</strong>
            </td>
            }

            else if (((item.Cert1EndDate - DateTime.Now).TotalDays <= 30 && item.RequiredCerts.Contains("1")) || ((item.Cert2EndDate - DateTime.Now).TotalDays <= 30 && item.RequiredCerts.Contains("2")) || ((item.Cert3EndDate - DateTime.Now).TotalDays <= 30 && item.RequiredCerts.Contains("3")))
            {
            <td bgcolor="#FFFF00">
                <strong>Less than 30 days</strong>
            </td>
            }
            else if (((item.Cert1EndDate - DateTime.Now).TotalDays > 30 && item.RequiredCerts.Contains("1")) || ((item.Cert2EndDate - DateTime.Now).TotalDays > 30 && item.RequiredCerts.Contains("2")) || ((item.Cert3EndDate - DateTime.Now).TotalDays > 30 && item.RequiredCerts.Contains("3")))
            {
            <td bgcolor="#00FF00">
                <strong>Good</strong>
            </td>
            }
            else
            { 
                <td></td>
            }
            @*<td>
            @Html.DisplayFor(modelItem => item.Address)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.City)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.State)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Zip)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Phone)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.DateOfBirth)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.HireDate)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.LicenseNumber)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.CertificationType)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.CertificationStartDate)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.CertificationEndDate)
        </td>*@
            <td>
                <a asp-action="Details" asp-route-id="@item.Id">Details</a>
                @if (User.IsInRole("Admin") || User.IsInRole("Manager"))
                {
                    @Html.Raw("|")
                    <a asp-action="Edit" asp-route-id="@item.Id">Edit</a> @Html.Raw("|")
                    <a asp-action="Certifications" asp-route-id="@item.Id">Certficications</a> @Html.Raw("|")
                    <a asp-action="Delete" asp-route-id="@item.Id">Delete</a>
                }
            </td>
        </tr>
}
    </tbody>
</table>
